<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Note Vault</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="header-left">
        <button id="currentProfileBtn" class="profile-btn" title="Click to manage profiles">Load Profile</button>
      </div>
      
      <h1>Note Vault</h1>
      
      <div class="header-right"></div>
    </header>

    <main class="app-main">
      <section class="panel panel-left" aria-label="Note index">
        <div class="panel-header">
          <div class="search-wrapper">
            <input type="text" id="searchInput" placeholder="Filter by Part ID..." />
            <i class="fa-solid fa-magnifying-glass search-icon"></i>
          </div>
        </div>
        <div id="notesList" class="notes-list" role="list"></div>
      </section>

      <section class="panel panel-center" aria-label="Note viewer">
        <div class="viewer-header">
          <button id="expandBtn">Expand Note</button>
          <button id="printBtn">Export to PDF</button>
          <div class="viewer-title" id="viewerTitle">—</div>
        </div>
        <article id="viewer" class="viewer" aria-live="polite"></article>
      </section>

      <section class="panel panel-right" aria-label="Note editor">
        <div class="editor-header">
          <button id="addNoteBtn">
            <i class="fa-solid fa-plus"></i> Add New Note
          </button>
          <button id="copyNoteBtn">
            <i class="fa-solid fa-copy"></i> Copy Note
          </button>
          <button id="deleteNoteBtn" class="danger">
            <i class="fa-solid fa-trash-can"></i> Delete Note
          </button>
        </div>
        <form id="editorForm" class="editor" autocomplete="off">
          <label class="field">
            <span>PART ID</span>
            <input
              id="partIdInput"
              type="text"
              placeholder="PART ID"
              required
            />
          </label>
          
          <label id="notesField" class="field">
            <span>INSPECTION NOTES</span>
            <textarea
              id="notesInput"
              rows="10"
              placeholder="Enter details, steps, references..."
            ></textarea>
          </label>

          <div class="images-toolbar">
            <button type="button" id="addImageBtn">Add Image</button>
          </div>
          <input id="imageInput" type="file" accept="image/*" multiple hidden />

          <div id="imagesContainer" class="images-container"></div>
          <label class="field">
            <span>Image caption (optional)</span>
            <input
              id="imageCaptionInput"
              type="text"
              placeholder="Caption applies to selected image"
            />
          </label>
        </form>
      </section>
    </main>

    <div id="cropperModal" class="modal" aria-hidden="true" role="dialog" aria-label="Image cropper">
      <div class="modal-dialog">
        <div class="modal-header">
          <div>Crop Image (1:1)</div>
          <button id="cropperCloseBtn" aria-label="Close">✕</button>
        </div>
        <div class="modal-body">
          <div class="cropper-stage">
            <img id="cropperImage" alt="To crop" />
            <div id="cropBox" class="crop-box" tabindex="0"></div>
          </div>
        </div>
        <div class="modal-footer">
            <div class="crop-controls">
              <button id="cropMinusBtn" title="Smaller">−</button>
              <input id="cropSizeRange" type="range" min="40" max="800" value="300" />
              <button id="cropPlusBtn" title="Larger">+</button>
              <button id="cropCenterBtn" title="Center crop box">Center</button>
              <span class="muted">Tip: Drag to move, drag corners to resize, wheel to resize</span>
            </div>
          <button id="cropperCancelBtn">Cancel</button>
          <button id="cropperApplyBtn" class="primary">Apply Crop</button>
        </div>
      </div>
    </div>

    <div id="imageViewerModal" class="modal" aria-hidden="true" role="dialog" aria-label="Image viewer">
      <div class="modal-dialog">
        <div class="modal-body" style="padding: 10px;">
          <img id="modalViewerImage" alt="Zoomed image" />
        </div>
        <div class="modal-footer">
          <button id="modalViewerCloseBtn">Close</button>
        </div>
      </div>
    </div>

    <div id="profileModal" class="modal" aria-hidden="true" role="dialog" aria-label="Manage Profiles">
      <div class="modal-dialog" style="width: min(90vw, 500px)">
        <div class="modal-header">
          <div>Manage Profiles</div>
          <button id="profileCloseBtn" aria-label="Close">✕</button>
        </div>
        <div class="modal-body">
          <div class="field">
            <span>AVAILABLE PROFILES</span>
            <div id="profileList" class="profile-list"></div>
          </div>
          
          <div class="field" style="margin-top: 12px;">
            <span>CREATE NEW PROFILE</span>
            <div class="field-row">
              <input id="newProfileInput" type="text" placeholder="Enter new profile name..." />
              <button id="createProfileBtn" class="primary">Create</button>
            </div>
          </div>
        </div>
        <div class="modal-footer">
            <button id="importDataBtn">Import Profile</button>
            <button id="exportDataBtn">Export Profile</button>
        </div>
      </div>
    </div>

    <div id="appAlertModal" class="modal" aria-hidden="true" style="z-index: 200;">
      <div class="modal-dialog" style="width: 400px; max-width: 90vw;">
        <div class="modal-header">
          <div id="appAlertTitle">Alert</div>
          <button id="appAlertCloseBtn">✕</button>
        </div>
        <div class="modal-body">
          <p id="appAlertMessage" style="white-space: pre-wrap;"></p>
        </div>
        <div class="modal-footer">
          <button id="appAlertOkBtn" class="primary" style="margin-left: auto;">OK</button>
        </div>
      </div>
    </div>

    <div id="appConfirmModal" class="modal" aria-hidden="true" style="z-index: 200;">
      <div class="modal-dialog" style="width: 400px; max-width: 90vw;">
        <div class="modal-header">
          <div id="appConfirmTitle">Confirm</div>
        </div>
        <div class="modal-body">
          <p id="appConfirmMessage" style="white-space: pre-wrap;"></p>
        </div>
        <div class="modal-footer">
          <button id="appConfirmCancelBtn">Cancel</button>
          <button id="appConfirmOkBtn" class="danger">OK</button>
        </div>
      </div>
    </div>

    <template id="noteListItemTemplate">
      <button class="note-item" role="listitem">
        <div class="thumb"></div>
        <div class="thumb-overlay">
          <div class="title"></div>
        </div>
      </button>
    </template>

    <script src="app.js"></script>
  </body>
</html>